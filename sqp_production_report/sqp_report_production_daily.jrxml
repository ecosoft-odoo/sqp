<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="sqp_report_production_status" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="822" leftMargin="10" rightMargin="10" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.9965000000000024"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="table" lineSpacing="Single">
		<box topPadding="2" leftPadding="1" bottomPadding="1" rightPadding="1">
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="record" lineSpacing="Single">
		<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
			<pen lineWidth="1.0" lineColor="#000000"/>
			<topPen lineWidth="0.25" lineStyle="Dotted"/>
			<bottomPen lineWidth="0.25" lineStyle="Dotted"/>
		</box>
	</style>
	<style name="header" mode="Opaque" forecolor="#000000" backcolor="#C0C0C0" lineSpacing="Single">
		<box topPadding="2" leftPadding="1" bottomPadding="1" rightPadding="1">
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_line" lineSpacing="Single">
		<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
			<pen lineWidth="1.0" lineColor="#000000"/>
			<topPen lineWidth="0.0"/>
			<bottomPen lineWidth="0.0"/>
		</box>
	</style>
	<parameter name="IDS" class="java.lang.Object" isForPrompting="false">
		<defaultValueExpression><![CDATA[$P{IDS}.toList()]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["/home/kittiu/workspace/openerp_sqp/sqp_addons/jrxml_reports/sale/"]]></defaultValueExpression>
	</parameter>
	<parameter name="report_date" class="java.lang.String"/>
	<parameter name="date" class="java.util.Date">
		<defaultValueExpression><![CDATA[(new java.text.SimpleDateFormat("yyyy-MM-dd")).parse($P{report_date})]]></defaultValueExpression>
	</parameter>
	<parameter name="dept" class="java.lang.String"/>
	<queryString>
		<![CDATA[select now() + interval '7 hours' as today, *, inside || '/' || outside as skin from
(select
	case
		when dept='S1' then 'SF'
		when dept='S2' then 'AS'
		when dept='S3' then 'IJ'
		when dept='S4' then 'DO'
		when dept='S5' then 'FN'
	end as dept,
  so.name so, so.ref_project_name project, history.line_number, pp.name_template as product, pp."W", pp."L", thick.value as "T",
(select code from bom_choice_skin where id = pp.mat_inside_skin_choices) inside,
(select code from bom_choice_skin where id = pp.mat_outside_skin_choices) outside,
date, order_qty, normal_qty, ot_qty from
-- Change History
(select normal.dept, normal.mo_id, normal.line_number, normal.product_id, normal.date, coalesce(normal.order_qty, ot.order_qty) as order_qty, normal_qty, ot_qty from
(
    select dept, mo_id, line_number, product_id, date, order_qty, max(new_value) - min(old_value) as normal_qty
    from
    (select atl.field_description dept, status.production_id mo_id,
	case
		when atl.field_description='S1' then status.s1_line
		when atl.field_description='S2' then status.s2_line
		when atl.field_description='S3' then status.s3_line
		when atl.field_description='S4' then status.s4_line
		when atl.field_description='S5' then status.s5_line
	end as line_number,
    status.product_id, status.product_qty as order_qty, date_trunc('day', at.create_date) date,
    coalesce(new_value_text, '0')::float new_value, coalesce(old_value_text, '0')::float old_value
    from mrp_production_status status
    left outer join audittrail_log at on status.id = at.res_id
    join audittrail_log_line atl on at.id = atl.log_id
    where at.object_id = (select id from ir_model where model='mrp.production.status')
    and atl.field_description in ('S1', 'S2', 'S3', 'S4', 'S5')
    and at.create_date - interval '7 hour' >= $P{date} and at.create_date - interval '17 hour' <= $P{date}
    ) normal
    group by dept, mo_id, line_number, product_id, date, order_qty
) normal
full outer join
(
    select dept, mo_id, line_number, product_id, date, order_qty, max(new_value) - min(old_value) as ot_qty
    from
    (select atl.field_description dept, status.production_id mo_id,
	case
		when atl.field_description='S1' then status.s1_line
		when atl.field_description='S2' then status.s2_line
		when atl.field_description='S3' then status.s3_line
		when atl.field_description='S4' then status.s4_line
		when atl.field_description='S5' then status.s5_line
	end as line_number,
	status.product_id, status.product_qty as order_qty, date_trunc('day', at.create_date) date,
    coalesce(new_value_text, '0')::float new_value, coalesce(old_value_text, '0')::float old_value
    from mrp_production_status status
    left outer join audittrail_log at on status.id = at.res_id
    join audittrail_log_line atl on at.id = atl.log_id
    where at.object_id = (select id from ir_model where model='mrp.production.status')
    and atl.field_description in ('S1', 'S2', 'S3', 'S4', 'S5')
    and at.create_date - interval '17 hour' > $P{date}  and at.create_date - interval '24 hour' <= $P{date}
    ) ot
    group by dept, mo_id, line_number, product_id, date, order_qty
) ot
on normal.dept = ot.dept and normal.mo_id = ot.mo_id and normal.product_id = ot.product_id and normal.date = ot.date) history
-- join for more information on MO
join mrp_production mo on mo.id = history.mo_id
join product_product pp on pp.id = history.product_id
left outer join bom_choice_thick thick on thick.id = pp."T"
join sale_order so on so.id = mo.order_id
order by dept, date, history.line_number, so.name) a
where a.dept = $P{dept}]]>
	</queryString>
	<field name="date" class="java.util.Date"/>
	<field name="dept" class="java.lang.String"/>
	<field name="so" class="java.lang.String"/>
	<field name="project" class="java.lang.String"/>
	<field name="product" class="java.lang.String"/>
	<field name="W" class="java.lang.Number"/>
	<field name="L" class="java.lang.Number"/>
	<field name="T" class="java.lang.String"/>
	<field name="skin" class="java.lang.String"/>
	<field name="order_qty" class="java.lang.Number"/>
	<field name="normal_qty" class="java.lang.Number"/>
	<field name="ot_qty" class="java.lang.Number"/>
	<field name="today" class="java.sql.Timestamp"/>
	<field name="line_number" class="java.lang.String"/>
	<variable name="dept" class="java.lang.String">
		<variableExpression><![CDATA[$F{dept}]]></variableExpression>
	</variable>
	<variable name="normal_qty" class="java.lang.Number">
		<variableExpression><![CDATA[$F{normal_qty} == null ? 0.0 : $F{normal_qty}]]></variableExpression>
	</variable>
	<variable name="ot_qty" class="java.lang.Number">
		<variableExpression><![CDATA[$F{ot_qty} == null ? 0.0 : $F{ot_qty}]]></variableExpression>
	</variable>
	<variable name="total_qty" class="java.lang.Number">
		<variableExpression><![CDATA[$V{ot_qty} + $V{normal_qty}]]></variableExpression>
	</variable>
	<variable name="sqm" class="java.lang.Number">
		<variableExpression><![CDATA[($F{W} == null ? 0.0 : $F{W}) *
($F{L} == null ? 0.0 : $F{L}) *
($V{normal_qty} + $V{ot_qty}) / 1000000]]></variableExpression>
	</variable>
	<variable name="total_normal_qty" class="java.lang.Number" resetType="Group" resetGroup="SOGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{normal_qty}]]></variableExpression>
	</variable>
	<variable name="total_ot_qty" class="java.lang.Number" resetType="Group" resetGroup="SOGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{ot_qty}]]></variableExpression>
	</variable>
	<variable name="total_total_qty" class="java.lang.Number" resetType="Group" resetGroup="SOGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{total_qty}]]></variableExpression>
	</variable>
	<variable name="total_sqm" class="java.lang.Number" resetType="Group" resetGroup="SOGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{sqm}]]></variableExpression>
	</variable>
	<variable name="total_order_qty" class="java.lang.Number" resetType="Group" resetGroup="SOGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{order_qty}]]></variableExpression>
	</variable>
	<variable name="total_normal_qty_1" class="java.lang.Number" calculation="Sum">
		<variableExpression><![CDATA[$V{normal_qty}]]></variableExpression>
	</variable>
	<variable name="total_ot_qty_1" class="java.lang.Number" calculation="Sum">
		<variableExpression><![CDATA[$V{ot_qty}]]></variableExpression>
	</variable>
	<variable name="total_total_qty_1" class="java.lang.Number" calculation="Sum">
		<variableExpression><![CDATA[$V{total_qty}]]></variableExpression>
	</variable>
	<variable name="total_sqm_1" class="java.lang.Number" calculation="Sum">
		<variableExpression><![CDATA[$V{sqm}]]></variableExpression>
	</variable>
	<variable name="total_order_qty_1" class="java.lang.Number" calculation="Sum">
		<variableExpression><![CDATA[$F{order_qty}]]></variableExpression>
	</variable>
	<variable name="line_number" class="java.lang.String">
		<variableExpression><![CDATA[$F{line_number}]]></variableExpression>
	</variable>
	<variable name="total_normal_qty_2" class="java.lang.Number" resetType="Group" resetGroup="LineGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{normal_qty}]]></variableExpression>
	</variable>
	<variable name="total_ot_qty_2" class="java.lang.Number" resetType="Group" resetGroup="LineGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{ot_qty}]]></variableExpression>
	</variable>
	<variable name="total_total_qty_2" class="java.lang.Number" resetType="Group" resetGroup="LineGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{total_qty}]]></variableExpression>
	</variable>
	<variable name="total_sqm_2" class="java.lang.Number" resetType="Group" resetGroup="LineGroup" calculation="Sum">
		<variableExpression><![CDATA[$V{sqm}]]></variableExpression>
	</variable>
	<variable name="total_order_qty_2" class="java.lang.Number" resetType="Group" resetGroup="LineGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{order_qty}]]></variableExpression>
	</variable>
	<group name="Total">
		<groupExpression><![CDATA[$F{dept}]]></groupExpression>
		<groupFooter>
			<band height="27">
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="641" y="0" width="40" height="27" forecolor="#000000" backcolor="#CCCCCC"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_ot_qty_1}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="561" y="0" width="40" height="27" forecolor="#000000" backcolor="#CCCCCC"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_order_qty_1}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="601" y="0" width="40" height="27" forecolor="#000000" backcolor="#CCCCCC"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_normal_qty_1}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="1" y="0" width="560" height="27" forecolor="#000000" backcolor="#CCCCCC"/>
					<textElement verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="732" y="0" width="90" height="27" forecolor="#000000" backcolor="#CCCCCC"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_sqm_1}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="681" y="0" width="51" height="27" forecolor="#000000" backcolor="#CCCCCC"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_total_qty_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="LineGroup">
		<groupExpression><![CDATA[$F{dept}+$F{line_number}]]></groupExpression>
		<groupHeader>
			<band height="19">
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="1" y="0" width="821" height="19"/>
					<textElement verticalAlignment="Top" lineSpacing="Single">
						<font fontName="Monospaced" size="12" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[($F{dept} == "SF" ? "Sheet Forming" : (
    $F{dept} == "AS" ? "Assembly" : (
        $F{dept} == "IJ" ? "Injection" : (
            $F{dept} == "DO" ? "Door" : (
                $F{dept} == "FN" ? "Finishing" : "")))))
+ " / " +
($F{line_number}.toString() == "" ? "" : (
  $F{line_number} == "L1" ? "Line 1" : (
    $F{line_number} == "L2" ? "Line 2" : (
        $F{line_number} == "L3" ? "Line 3" : (
            $F{line_number} == "L4" ? "Line 4" : (
                $F{line_number} == "L5" ? "Line 5" : ""))))))]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="25">
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="1" y="0" width="560" height="20" forecolor="#000000" backcolor="#CDCDCD"/>
					<textElement verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="601" y="0" width="40" height="20" forecolor="#000000" backcolor="#CDCDCD"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_normal_qty_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="641" y="0" width="40" height="20" forecolor="#000000" backcolor="#CDCDCD"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_ot_qty_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="732" y="0" width="90" height="20" forecolor="#000000" backcolor="#CDCDCD"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_sqm_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="561" y="0" width="40" height="20" forecolor="#000000" backcolor="#CDCDCD"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_order_qty_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="681" y="0" width="51" height="20" forecolor="#000000" backcolor="#CDCDCD"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_total_qty_2}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="SOGroup">
		<groupExpression><![CDATA[$F{dept}+$F{line_number}+$F{so}]]></groupExpression>
		<groupFooter>
			<band height="20">
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="561" y="0" width="40" height="20" forecolor="#000000" backcolor="#E5E5E5"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_order_qty}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="641" y="0" width="40" height="20" forecolor="#000000" backcolor="#E5E5E5"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_ot_qty}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="732" y="0" width="90" height="20" forecolor="#000000" backcolor="#E5E5E5"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_sqm}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="601" y="0" width="40" height="20" forecolor="#000000" backcolor="#E5E5E5"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_normal_qty}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="681" y="0" width="51" height="20" forecolor="#000000" backcolor="#E5E5E5"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_total_qty}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement style="table" stretchType="RelativeToTallestObject" mode="Opaque" x="1" y="0" width="560" height="20" forecolor="#000000" backcolor="#E5E5E5"/>
					<textElement verticalAlignment="Middle" lineSpacing="Single">
						<font fontName="Monospaced" size="8" isBold="true" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
				</textField>
			</band>
		</groupFooter>
	</group>
	<title>
		<band height="42" splitType="Stretch">
			<staticText>
				<reportElement x="-1" y="20" width="261" height="20"/>
				<textElement verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="14" isBold="true" isUnderline="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[ใบบันทึกการผลิตประจำวันที่]]></text>
			</staticText>
			<staticText>
				<reportElement x="662" y="20" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="10" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[ วันที่บังคับใช้ 05/01/52]]></text>
			</staticText>
			<staticText>
				<reportElement x="1" y="0" width="186" height="20"/>
				<textElement verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="12" isBold="true" isUnderline="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Square Panel Co., Ltd.]]></text>
			</staticText>
			<staticText>
				<reportElement x="681" y="0" width="121" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="10" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[PD - F - 70 Rev.0]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="191" y="20" width="182" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="Monospaced" size="13" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{date}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="30" splitType="Stretch">
			<staticText>
				<reportElement style="header" x="1" y="0" width="64" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Order
NO.CRL-]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="65" y="0" width="166" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Project Name]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="231" y="0" width="170" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Panel No. Code]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="401" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[กว้าง
(m.m.)]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="521" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[หนา
(m.m.)]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="481" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[สีพื้นผิว
หน้า/หลัง]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="441" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[ยาว
(m.m.)]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="561" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Order
รวม]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="601" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Day Qty
(pcs.)]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="641" y="0" width="40" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[OT Qty
(pcs.)]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="732" y="0" width="90" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[พื้นที่แผ่น
(sqm)]]></text>
			</staticText>
			<staticText>
				<reportElement style="header" x="681" y="0" width="51" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="8" isBold="false" isItalic="false" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Total Qty
(pcs.)]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="1" y="0" width="64" height="15"/>
				<textElement verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{so}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="65" y="0" width="166" height="15"/>
				<textElement verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{project}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="231" y="0" width="170" height="15"/>
				<textElement verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{product}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="401" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{W}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="441" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{L}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="521" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{T}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="481" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{skin}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="561" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{order_qty}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="601" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$V{normal_qty}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="641" y="0" width="40" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$V{ot_qty}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="732" y="0" width="90" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$V{sqm}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="table" stretchType="RelativeToTallestObject" mode="Transparent" x="681" y="0" width="51" height="15"/>
				<textElement textAlignment="Center" verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$V{total_qty}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="16">
			<textField>
				<reportElement x="697" y="1" width="80" height="15"/>
				<textElement textAlignment="Right">
					<font size="9" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="777" y="1" width="40" height="15"/>
				<textElement>
					<font size="9" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="1" width="122" height="15"/>
				<textElement verticalAlignment="Top" lineSpacing="Single">
					<font fontName="Monospaced" size="10" isBold="false" isUnderline="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Printed Date:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement x="77" y="1" width="183" height="15"/>
				<textElement>
					<font isUnderline="false"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{today}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
